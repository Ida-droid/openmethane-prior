# OpenMethane prior emissions estimate

Method to calculate a gridded, prior emissions estimate for methane across Australia.

This repository is shipped with sample input data in the `inputs` so that it will run out of the box.

## Initialise

Run

```console
pip install -r requirements.txt
```

Copy the `.env.example` file to `.env` and customise the paths as you need. The example file refers to the sample inputs shipped in the `inputs` folder.

## Run

To generate the domain information needed for grid resolution etc run
```console
python omCreateDomainInfo.py
```
The current version is set up for CMAQ and uses three files from the
WRF and CMAQ setup process. Replace these with your own version for a
different CMAQ domain. For another model, look at the structure of the
domainXr variable in omCreateDomainInfo.py


To calculate emissions for all layers, run:

```console
python omPrior.py
```

To skip re-projecting raster layers (you only need to do this once for every time you change the input file), add the `--skip-reproject` option.

## Outputs

Outputs can be found in the `outputs` folder. The emissions layers will be written as variables to a copy of the input domain file, with an `OCH4_` prefix for the methane layer variable names. The sum of all layers will be sotred in the `OCH4_TOTAL` layer.

The name of the layered output file will be `om-{INPUT_DOMAIN_FILENAME}`.

The output folder will also contain any re-projected raster data.

## Layers
Many sectors are taken from data sets used in by Saunois et al (2020) (doi:10.5194/essd-12-1561-2020)
- Livestock: Enteric fermentation emissions generated by CSIRO Ag. and Food using livestock census data and UNFCCC emissions factors
- Electricity: Uses OpenNEM facility data to spatialise the Aust. Gov UNFCCC electricity emissions
- Agriculture: Agricultural emissions apart from livestock taken from the Agricultural emissions of the NGGI and spatialised according to the agriculture land-use mask
- Fugitives: Facility-level data from ACF (more info?)
- Industrial: Spatialises the industrial sector of the NGGI according to nighttime lights
- Stationary: Spatialises the  stationary  energy sector of the NGGI according to nighttime lights
- Transport: Spatialises the  transport sector of the NGGI according to nighttime lights
- Waste: Spatialises the NGGI waste emission according to the landuse map
- LULUCF: Spatialises the LULUCF emission from the NGGI according to the landuse map
- FIRE: daily emissions from the Global Fire Assimilation System (Kaiser et al., 2012, doi:10.5194/bg-9-527-2012)
- wetland: Monthly wetland emissions from the diagnostic ensemble used in Saunois et al. 2020 and described in Zhang et al. (2023 under review)
- Termite: Termite emissions used in Saunois et al. 2020 supplied by Simona Castaldi and Sergio Noce
